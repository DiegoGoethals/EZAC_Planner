@page "/calendarupdate/{calendarId}"
@rendermode InteractiveServer

@using Ezac.Roster.Domain.Interfaces.Services
@using Ezac.Roster.Domain.Entities
@using Ezac.Roster.Web.Components.Components
@using Ezac.Roster.Domain.Services.Models

@inject ICalendarService CalendarService
@inject NavigationManager NavigationManager

<CalendarOverview Calendar="_calendar" FormHandler="UpdateCalendar" />

@code {
    [Parameter]
    public string calendarId { get; set; }

    private ApplicationCalendar _calendar { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var result = await CalendarService.GetByIdAsync(Guid.Parse(calendarId));
        if (result.IsSucces)
        {
            _calendar = result.Value;
        }
	}

    private async Task UpdateCalendar()
    {
        var calendarUpdateRequestModel = new ApplicationCalendarUpdateRequestModel()
            {
                Id = _calendar.Id,
                Name = _calendar.Name,
                Start = _calendar.Start,
                End = _calendar.End,
                Days = _calendar.Days
            };

        await CalendarService.UpdateAsync(calendarUpdateRequestModel);
        NavigationManager.NavigateTo("calendarslist");
    }
}