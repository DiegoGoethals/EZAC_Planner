@page "/calendar-creator"
@rendermode InteractiveServer

@using Ezac.Roster.Domain.Interfaces.Services
@using Ezac.Roster.Domain.Entities
@using Ezac.Roster.Web.Components.Components
@using Ezac.Roster.Domain.Services.Models

@inject ICalendarService CalendarService
@inject NavigationManager NavigationManager

<CalendarOverview Calendar="_calendar" FormHandler="CreateCalendar"/>

@code {
    private ApplicationCalendar _calendar { get; set; }

    protected override void OnInitialized()
    {
        _calendar = new ApplicationCalendar()
        {
            Start = DateTime.Now,
            End = DateTime.Now,
            Days = new List<Day>()
        };
    }

    private async Task CreateCalendar()
    {
        var calendarCreateRequestModel = new ApplicationCalendarCreateRequestModel()
		{
			Name = _calendar.Name,
			Start = _calendar.Start,
			End = _calendar.End,
			Days = _calendar.Days
		};

        await CalendarService.AddAsync(calendarCreateRequestModel);
        NavigationManager.NavigateTo("calendarslist");
    }
}